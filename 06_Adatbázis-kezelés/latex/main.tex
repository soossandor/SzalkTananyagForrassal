% $Header: /cvsroot/latex-beamer/latex-beamer/solutions/conference-talks/conference-ornate-20min.en.tex,v 1.7 2007/01/28 20:48:23 tantau Exp $

% Version for PROJECTOR (Vetíthetõ változat)
% Uncomment the next line (A vetíthetõ változathoz vedd ki a % jelet a következõ sor elejérõl)
%\documentclass{beamer}
% End of version for PROJECTOR (A vetíthetõ változat vége)

% PRINTABLE version (Nyomtatható változat):
% Uncomment the next two lines (vedd ki a % jelet a következõ 2 sor elejérõl)
%\documentclass{article}
%\usepackage{beamerarticle}
% End of PRINTABLE version (A nyomtatott változat beállításának vége)


% This file is a solution template for:

% - Talk at a conference/colloquium.
% - Talk length is about 20min.
% - Style is ornate.



% Copyright 2004 by Till Tantau <tantau@users.sourceforge.net>.
%
% In principle, this file can be redistributed and/or modified under
% the terms of the GNU Public License, version 2.
%
% However, this file is supposed to be a template to be modified
% for your own needs. For this reason, if you use this file as a
% template and not specifically distribute it as part of a another
% package/program, I grant the extra permission to freely copy and
% modify this file as you see fit and even to delete this copyright
% notice. 


\mode<presentation>
{
  \usetheme{Warsaw}
  % or ...

  \setbeamercovered{transparent}
  % or whatever (possibly just delete it)
}

% Magyar szöveg
\usepackage[magyar]{babel}		% a Babel csomagot a magyar nyelvvel használjuk
\usepackage[latin2]{inputenc}		% Latin-2-es kódolású ez a forrás
\usepackage{t1enc}			% a belsõ ábrázolás és a kimeneti font-kódolás
					% a T1 kódolás
\usepackage{indentfirst}		% az elsõ bekezdés is behúzott legyen, ne csak a 2-tól
\frenchspacing				% a mondatköz ugyanakkora nagy, mint a szóköz
\setlength{\parskip}{\smallskipamount}	% bekezdések közötti távolság beállítása
					% (gumi-méret: 3pt plus 1pt minus 1 pt)
% Magyar szöveg vége


% Angol szöveg
%\usepackage[english]{babel}
%\usepackage[latin1]{inputenc}
%\usepackage{times}
%\usepackage[T1]{fontenc}
% Angol szöveg vége

% Or whatever. Note that the encoding and the font should match. If T1
% does not look nice, try deleting the line with the fontenc.

\def\screenshotsize{0.70}
\def\screenshotsizeB{0.50}
\def\maintitle{Számítógépes alkalmazások\\Adatbázis-kezelés}
\def\shorttitle{SZALK - Adatbázis-kezelés}
\def\longdate{Sopron, 2015.}
\def\shortdate{2015}

%packages to use
\usepackage{graphicx}
\usepackage{fancybox} 
\usepackage{multicol}

\only<beamer>{
%Insert frame number to footline
%Tested with the next themes: Warsaw, Berlin, Szeged, ...
\newcommand*\oldmacro{}%
\let\oldmacro\insertshorttitle%
\renewcommand*\insertshorttitle{%
  \oldmacro\hfill%
  \insertframenumber\,/\,\inserttotalframenumber}
%End of frame number to footline
}

\title[\shorttitle] % (optional, use only with long paper titles)
{\maintitle}

\author[Soós Sándor] % (optional, use only with lots of authors)
{Soós Sándor, egyetemi adjunktus}
% - Give the names in the same order as the appear in the paper.
% - Use the \inst{?} command only if the authors have different
%   affiliation.

\institute[NYME FMK INGA] % (optional, but mostly needed)
{
%  \inst{1}%
  Nyugat-magyarországi Egyetem\\
  Simonyi Károly Mûszaki, Faanyagtudományi és Mûvészeti Kar\\
  Informatikai és Gazdasági Intézet\\
  \vspace{0.3cm}
  E-mail: soossandor@inf.nyme.hu
}
% - Use the \inst command only if there are several affiliations.
% - Keep it simple, no one is interested in your street address.

\date[\shortdate] % (optional, should be abbreviation of conference name)
{\longdate}
% - Either use conference name or its abbreviation.
% - Not really informative to the audience, more for people (including
%   yourself) who are reading the slides online

% Delete this, if you do not want the table of contents to pop up at
% the beginning of each subsection:
\AtBeginSubsection[]
{
  \begin{frame}<beamer>{Outline}
    \tableofcontents[currentsection,currentsubsection]
  \end{frame}
}


% If you wish to uncover everything in a step-wise fashion, uncomment
% the following command: 

%\beamerdefaultoverlayspecification{<+->}

\begin{document}


\only<article>{
	\begin{titlepage}
		
		\begin{center}
			
			%\vspace*{1cm}
			\Large
			\textsc{\maintitle}\\
			
			\vspace{5cm}
			
			%\LARGE
			\textsc{Soós Sándor}\\
			\vspace{2cm}
			Nyugat-magyarországi Egyetem\\
			Simonyi Károly Mûszaki, Faanyagtudományi és Mûvészeti Kar\\
			Informatikai és Gazdasági Intézet\\
			\vspace{0.3cm}
			soossandor@inf.nyme.hu\\
			\vspace{3cm}
			%\textsc{\today}\\ %%Date - better you write it yourself.
			\textsc{\longdate}\\
			
		\end{center}
		
	\end{titlepage}
}

% If you have a file called "university-logo-filename.xxx", where xxx
% is a graphic format that can be processed by latex or pdflatex,
% resp., then you can add a logo as follows:

\only<beamer>{
\pgfdeclareimage[height=1cm]{university-logo}{images/nyme_skk}
\logo{\pgfuseimage{university-logo}}
}

%\only<beamer>{\subject{Practical Computer Science}}
% This is only inserted into the PDF information catalog. Can be left
% out. 


\only<beamer>{
\begin{frame}{}
  \titlepage
\end{frame}
}

\begin{frame}{Tartalomjegyzék}
  \tableofcontents
  % You might wish to add the option [pausesections]
\end{frame}

\begin{frame}{Mirõl lesz szó a mai órán?}

\begin{itemize}
	\item adatok, adattáblák, adatbázisok
	\item tranzakciók, tranzakciókezelés
	\item zárolás, lock
	\item relációs adatmodell
	\item relációs algebra
	\item relációs adatbázisok
	\item funkcionális függõség
	\item redundancia
	\item anomáliák
	\item dekompozíció
	\item adatbázis-tervezés
\end{itemize}

\end{frame}

\section{Adatbázis-kezelés}
\label{sec:AzAdatbazisKezeles}

\subsection{Az adatbázis fogalma}
\label{sec:AzAdatbazisFogalma}

\begin{frame}{Adat és adatbázis}
	
	\begin{itemize}
		\item Az Excel-lel is kezeltünk adatokat
		\item Az adatbázis volt?
		\item Az Excel adatbázis-kezelõ?
		\item Mikor válik az adat adatbázissá?
	\end{itemize}
	
\end{frame}

\begin{frame}{Az adatbázis}
	
	\begin{itemize}
		\item Vizsgálandó szempontok:
		
		\begin{itemize}
			\item Méret
			
			\begin{itemize}
				\item elfér az operatív memóriában
				\item nem fér el az operatív memóriában
			\end{itemize}
			
			\item Bonyolultság
			
			\begin{itemize}
				\item egyszerû, egymástól független adatsorok (Excel)
				\item kapcsolatok vannak az adatok között
			\end{itemize}
			
			\item Speciális adattípusok kezelése
			
			\begin{itemize}
				\item kép
				\item hang
				\item videó
			\end{itemize}
			
		\end{itemize}
		
	\end{itemize}
	
\end{frame}

\begin{frame}{Az adatbázis}
	
	Mit nevezünk adatbázisnak?
	\begin{itemize}
		\item Az adatbázis azonos minõségû (jellemzõjû), többnyire strukturált adatok összessége, amelyet egy tárolására, lekérdezésére és szerkesztésére alkalmas szoftvereszköz kezel
		\item Az adatbázis nem azonos az adatbázis-kezelõvel!
	\end{itemize}
	
\end{frame}

\begin{frame}{Adatbázis-kezelõ}
	Mit várunk el egy adatbázis-kezelõ rendszertõl?
	
	\begin{enumerate}
		\item Tegye lehetõvé új adatbázisok létrehozását, az adatbázis logikai struktúrájának (séma) leírását egy erre alkalmas nyelven (adatdefiníciós nyelv)
		\item Tegye lehetõvé az adatok biztonságos tárolását
		\item Tegye lehetõvé az adatok felvitelét, módosítását és törlését (adatmanipuláció nyelv)
		\item Tegye lehetõvé az adatok lekérdezését (lekérdezõ nyelv)
		\item Legyen lehetõség a különbözõ mûveletek elvégzésének lehetõségét jogosultsági szintekhez kötni
		\item Mindez megbízhatóan és hatékonyan mûködjön akkor is, ha nagy mennyiségû (elvileg ,,korlátlan'') adatról van szó
		\item Mindez megbízhatóan mûködjön akkor is, ha egyszerre \\több felhasználó szeretne mûveleteket végezni
	\end{enumerate}
	
\end{frame}

\begin{frame}{Egy tipikus példa: Bank}
	
	\begin{itemize}
		\item Adatelemek:
		
		\begin{itemize}
			\item ügyfelek: név, cím, jogosultságok
			\item bankszámlák: folyószámlák, hitelszámlák, egyenlegek
			\item az ügyfelek és a számlák között fennálló kapcsolatok
			\item tranzakciók
		\end{itemize}
		
		\item Mûveletek: 
		
		\begin{itemize}
			\item új ügyfél létrehozása
			\item új számla nyitása
			\item számla megszüntetése
			\item pénz befizetése
			\item pénz kivétele
			\item pénz utalása egyik számláról a másikra
		\end{itemize}
		
	\end{itemize}
	
\end{frame}

\begin{frame}[plain]{Kritikus mûvelet: Pénz felvétele}
	
	\begin{itemize}
		\item Van egy bankszámla $100\ 000$ Ft-os egyenleggel
		\item A számlának két tulajdonosa van Zoli és Kati, mindkettõnek van joga pénzt befizetni és kivenni is 
		\item Egy idõben bemegy a két tulajdonos két különbözõ bankfiókba, mindkettõ fel akar venni $80\ 000$ Ft-ot
		\item Mi történik a rendszerben?
		
		\begin{enumerate}
			\item Zoli belép a budapesti bankfiókba, kér $80\ 000$ Ft-ot
			\item Az ügyintézõ megnézi a számlát, úgy látja van rajta ekkora összeg, elkezdi a kifizetést, megírja a pénztárbizonylatot
			\item Ekkor Kati belép a zalaegerszegi bankfiókba, kér $80\ 000$ Ft-ot
			\item A zalaegerszegi ügyintézõ ellenõrzi a számlát, az egyenleg $100\ 000$ Ft, megírja a pénztárbizonylatot
			\item A budapesti ügyintézõ kifizeti a pénzt, csökkenti a számla egyenlegét $20\ 000$ Ft-ra
			\item A zalaegerszegi ügyintézõ is fizet, csökkenti a számla egyenlegét $-60\ 000$ Ft-ra
			\item Mi történt? Miért?
		\end{enumerate}
		
	\end{itemize}
	
\end{frame}

\subsection{Tranzakciókezelés}
\label{sec:Tranzakciokezeles}

\begin{frame}{Tranzakciókezelés}
	
	A probléma:
	\begin{itemize}
		\item A probléma oka, hogy megengedtük, hogy bizonyos kritikus mûveletek végrehajtása közben mások is végrehajtódjanak, olyanok is, amelyek befolyásolhatják az elsõ mûvelet eredményét
		\item Konkrétan: két mûvelet tudta módosítani a számla egyenlegét egyidõben
	\end{itemize}
	
	A megoldás:
		
	\begin{enumerate}
		\item Definiáljunk olyan elemi mûveleteket, amelyek nem szakíthatók félbe, vagy a teljes folyamat lezajlik, vagy nem történik semmi (Tranzakció, Transaction)
		\item Kritikus mûveletek elvégzésének idejére zároljuk az \\adatbázis egyes részeit, hogy másik folyamat ne \\férhessen hozzá (Zárolás, Lock)
	\end{enumerate}
		
\end{frame}

\begin{frame}[plain]{Pénzfelvétel biztonságosan}
	Az elõzõ pénzfelvétel így néz ki biztonságosan:
	
		\begin{enumerate}
			\item Zoli belép a budapesti bankfiókba, kér $80\ 000$ Ft-ot
			\item Az ügyintézõ megnézi a számlát, úgy látja van rajta ekkora összeg, ezért zárolja a számlát és elindít egy pénzfelvételi tranzakciót
			\item Ekkor Kati belép a zalaegerszegi bankfiókba, kér $80\ 000$ Ft-ot
			\item A zalaegerszegi ügyintézõ ellenõrzi a számlát, az egyenleg $100\ 000$ Ft, de a számla zárolt, ezért nem indíthat el egy pénzfelvételi tranzakciót, várakozik
			\item A budapesti ügyintézõ kifizeti a pénzt, csökkenti a számla egyenlegét $20\ 000$ Ft-ra, ezzel sikeresen befejezõdik a tranzakció, feloldjuk a zárolást
			\item A zalaegerszegi ügyintézõ észleli, hogy újra szabad a számla, de az egyenleg már csak $20\ 000$ Ft
			\item Megmondja az ügyfélnek, hogy nincsen $80\ 000$ Ft a számlán
		\end{enumerate}
	
\end{frame}

\begin{frame}{Tranzakció}
	
	Tranzakció:
	
	\begin{itemize}
		\item Az idegen szavak szótárában: 
		
		\begin{itemize}
			\item bankügylet
		\end{itemize}
		
		\item Az informatikában: 
		
		\begin{itemize}
			\item olyan több lépésbõl álló mûveletsor, ami csak egységes egészként hajtható végre
			\item vagy lefut az egész tranzakció, vagy nem történik semmi
			\item ha a tranzakció elkezdõdik, de valamilyen okból nem tud szabályosan befejezõdni, akkor a rendszer visszavonja az eddig végrehajtott lépéseket, visszaállítja a tranzakció elindulása elõtti állapotot
			\item nem csak banki rendszerekben és nem is csak \\adatbázis-kezelõ rendszerekben használjuk
		\end{itemize}
		
	\end{itemize}
	
\end{frame}

\begin{frame}[fragile]{Tranzakciókezelés}

\begin{verbatim}
TRANSACTION BEGIN
...
  a tranzakció lépései
...
if (nincs hiba) then
  COMMIT
else
  ROLLBACK
endif
\end{verbatim}

\begin{itemize}
	\item a programozónak ennyit kell tennie
	\item a többit elintézi a tranzakciókezelõ rendszer
\end{itemize}
	
\end{frame}


\begin{frame}[fragile]{Zárolás -- Lock}

\begin{itemize}
	\item Adott egy megosztott erõforrás, amit több felhasználó szeretne használni, de egy idõben csak az egyik férhet hozzá
	\item Pl. közös nyomtató, egy fájl a fájlszerveren, egy rekord az adatbázisban, \dots
	\item Minden felhasználó a következõképpen használja az erõforrást:
\end{itemize}
	
\begin{verbatim}
...
ERÕFORRÁS LOCK
...
  az erõforrás használata
...
ERÕFORRÁS UNLOCK
...
\end{verbatim}	
	
\end{frame}

\begin{frame}[fragile]{Zárolás -- Lock}
	
	\begin{itemize}
		\item nagyon fontos, hogy ha egyszer zároltunk egy erõforrást, akkor azt fel is szabadítsuk
		\item ha elmarad, akkor senki nem fog tudni hozzáférni az erõforráshoz, rendszergazdai beavatkozásra van szükség
		\item kombináljuk a két megoldást, egy tranzakcióban használjuk az erõforrásokat
	\end{itemize}

\begin{verbatim}
TRANSACTION BEGIN
  ERÕFORRÁS LOCK
    az erõforrás használata
  ERÕFORRÁS UNLOCK
if (nincs hiba) then
  COMMIT
else
  ROLLBACK
endif
\end{verbatim}
	
\end{frame}

\section{Adatbázis-kezelõ rendszerek}
\label{sec:AdatbazisKezeloRendszerek}

\begin{frame}{Adatbázis-kezelõ rendszerek típusai}
	
	\begin{itemize}
		\item hierarchikus
		\item hálós
		\item relációs
		\item objektumorientált
		\item deduktív
	\end{itemize}
	
	Napjainkban a relációs adatmodell és az erre épülõ adatbázis-kezelõ rendszerek a legelterjedtebbek
	
	Ezzel fogunk megismerkedni
	
\end{frame}

\subsection{Relációs adatmodell}
\label{sec:RelaciosAdatmodell}

\begin{frame}{Relációs adatmodell}
	
	\begin{itemize}
		\item E. F. Codd: \\
A relational model of data for large shared data banks. \\
Communications of the ACM, 13 (1970), 377-387.
		\item A felhasználó számára táblázatok (relációk) formájában jeleníti meg az adatokat
		\item A relációkkal relációs algebrai mûveleteket végezhetünk
		
		\begin{itemize}
			\item Descartes-szorzat ($\times$)
			\item Halmazelméleti unió ($\cup$)
			\item Halmazelméleti különbség ($\setminus$)
			\item Kiválasztás, szelekció ($K$)
			\item Vetítés, projekció ($V$)
		\end{itemize}

	\end{itemize}
	
\end{frame}

\begin{frame}[plain]{Relációk példa}
	\begin{columns}
	  \begin{column}{0.3\textwidth}
			
			\begin{center}
				Alaprelációk
			\end{center}
			
			\begin{table}
				\centering
					\only<beamer>{\rowcolors[]{1}{blue!20}{blue!10} }
					\begin{tabular}{|c|c|}
					\hline
					$r_1$ & Vezetéknév \\ \hline \hline
					1 & Kovács \\ \hline
					2 & Szabó \\
					\hline
					\end{tabular}
			\end{table}
			
			\begin{table}
				\centering
					\only<beamer>{\rowcolors[]{1}{blue!20}{blue!10} }
					\begin{tabular}{|c|c|}
					\hline
					$r_2$ & Keresztnév \\ \hline \hline
					1 & János \\ \hline
					2 & István \\ \hline
					3 & Zoltán \\
					\hline
					\end{tabular}
			\end{table}
			
		\end{column}
		
	  \begin{column}{0.7\textwidth}
			
			\begin{center}
				Direktszorzat: $r_3 = r_1 \times r_2$
			\end{center}
			\begin{table}
				\centering
					\only<beamer>{\rowcolors[]{1}{blue!20}{blue!10} }
					\begin{tabular}{|c|c|c|}
					\hline
					$r_3$ & Vezetéknév & Keresztnév\\ \hline \hline
					1 & Kovács & János \\ \hline
					2 & Kovács & István \\ \hline
					3 & Kovács & Zoltán \\ \hline
					4 & Szabó & János \\ \hline
					5 & Szabó & István \\ \hline
					6 & Szabó & Zoltán \\ \hline
					\end{tabular}
			\end{table}
			
		\end{column}

	\end{columns}
\end{frame}

\begin{frame}[plain]{Relációk példa}
	\begin{columns}
	  \begin{column}{0.3\textwidth}
			
			\begin{center}
				Alaprelációk
			\end{center}
			
			\begin{table}
				\centering
					\only<beamer>{\rowcolors[]{1}{blue!20}{blue!10} }
					\begin{tabular}{|c|c|}
					\hline
					$r_1$ & Vezetéknév \\ \hline \hline
					1 & Kovács \\ \hline
					2 & Szabó \\
					\hline
					\end{tabular}
			\end{table}
			
			\begin{table}
				\centering
					\only<beamer>{\rowcolors[]{1}{blue!20}{blue!10} }
					\begin{tabular}{|c|c|}
					\hline
					$r_2$ & Keresztnév \\ \hline \hline
					1 & János \\ \hline
					2 & István \\ \hline
					3 & Zoltán \\
					\hline
					\end{tabular}
			\end{table}
			
		\end{column}
		
	  \begin{column}{0.7\textwidth}
			
			\begin{center}
				Unió: $r_4 = r_1 \cup r_2$
			\end{center}

			\begin{table}
				\centering
					\only<beamer>{\rowcolors[]{1}{blue!20}{blue!10} }
					\begin{tabular}{|c|c|}
					\hline
					$r_4$ & Eredmény \\ \hline \hline
					1 & Kovács \\ \hline
					2 & Szabó \\ \hline
					3 & János \\ \hline
					4 & István \\ \hline
					5 & Zoltán \\
					\hline
					\end{tabular}
			\end{table}
			
		\end{column}

	\end{columns}
\end{frame}

\begin{frame}[plain]{Relációk példa}
	\begin{columns}
	  \begin{column}{0.5\textwidth}
			
			\begin{table}
				\centering
					\only<beamer>{\rowcolors[]{1}{blue!20}{blue!10} }
					\begin{tabular}{|c|c|c|}
					\hline
					$r_3$ & Vezetéknév & Keresztnév\\ \hline \hline
					1 & Kovács & János \\ \hline
					2 & Kovács & István \\ \hline
					3 & Kovács & Zoltán \\ \hline
					4 & Szabó & János \\ \hline
					5 & Szabó & István \\ \hline
					6 & Szabó & Zoltán \\ \hline
					\end{tabular}
			\end{table}
			
		\end{column}
		
	  \begin{column}{0.5\textwidth}
			
			\begin{center}
				Kiválasztás:\\ 
				$r_5 = K_{Keresztnev='Janos'}(r_3)$
			\end{center}
			
			\begin{table}
				\centering
					\only<beamer>{\rowcolors[]{1}{blue!20}{blue!10} }
					\begin{tabular}{|c|c|c|}
					\hline
					$r_5$ & Vezetéknév & Keresztnév\\ \hline \hline
					1 & Kovács & János \\ \hline
					2 & Szabó & János \\ \hline
					\end{tabular}
			\end{table}

			\begin{center}
				Vetítés:\\ 
				$r_6 = V_{Vezeteknev}(r_5)$
			\end{center}
			
			\begin{table}
				\centering
					\only<beamer>{\rowcolors[]{1}{blue!20}{blue!10} }
					\begin{tabular}{|c|c|}
					\hline
					$r_6$ & Vezetéknév \\ \hline \hline
					1 & Kovács \\ \hline
					2 & Szabó \\ \hline
					\end{tabular}
			\end{table}
		\end{column}

	\end{columns}
	
\end{frame}

\begin{frame}[fragile]{Relációk példa}
	Ugyanez SQL-ben:
	
	\begin{verbatim}
		SELECT Vezetéknév 
		FROM Nevek
		WHERE Keresztnev = 'János'
	\end{verbatim}
\end{frame}

\begin{frame}{Hogyan alakítsuk ki a relációkat, táblákat?}
	
	\begin{itemize}
		\item Az adatbázis késõbbi használhatósága attól függ, hogy mennyire alaposan terveztük meg az adatbázis szerkezetét
		\item Ez egy önálló tudományág (Adatbázis-tervezés), de az alapjait mindenkinek érdemes megismernie
		\item Alapelv: Olyan adatbázist tervezzünk, ami a rendszeres használat során is sértetlen marad!
		\item Mit jelent a sértetlenség?
		
		\begin{itemize}
			\item Úgy kell kialakítani a táblákat, hogy új adatok beszúrása, módosítása, régiek törlése esetén is megmaradjon a logikai szerkezete
			\item Az alapvetõ cél a redundancia csökkentése, lehetõleg teljes megszüntetése
			\item Ebben az esetben redundancia alatt nem a szövegszerû ismétlõdést értjük, hanem a funkcionális függõség \\miatt elõálló ismétlõdést
		\end{itemize}
		
	\end{itemize}
	
\end{frame}

\subsection{Funkcionális függõség}
\label{sec:FunkcionalisFuggoseg}

\begin{frame}{Redundancia az adatbázisban}
	\begin{table}
	\centering
	  Dolgozók munkahelye
		\vspace{0.5cm}
		\only<beamer>{\rowcolors[]{1}{blue!20}{blue!10} }
		\footnotesize{
		\begin{tabular}{|c|c|c|c|c|c|}
		\hline
		$r_{mh}$ & Dolgozó neve & Cégnév & Mh. város & Irányítószám \\ \hline \hline
		1 & Molnár Piroska & Zalaegerszegi Kórház & Zalaegerszeg & 8900 \\ \hline
		2 & Horváth Katalin & Zalaegerszegi Kórház & Zalaegerszeg & 8900 \\ \hline
		3 & Egerszegi Judit & Zalaegerszegi Kórház & Zalaegerszeg & 8900 \\ \hline
		4 & Lenti Edit & Soproni Kórház & Sopron & 9400 \\ \hline
		5 & Keleti Edina & Soproni Kórház & Sopron & 9400 \\ \hline
		\end{tabular}
		}
\end{table}

\begin{itemize}
	\item Jó ez az adatbázis? \pause
	\item Mi a baj vele? \pause
	\item Hogyan javítsuk ki?
\end{itemize}

\end{frame}

\begin{frame}{Funkcionális függõség}
	
	\begin{itemize}
		\item Egy $A$ jellemzõ (oszlop) funkcionálisan függ egy $B$ jellemzõtõl, ha egy reláció (kitöltött táblázat) minden $s$ és $t$ elemére (sorára), ha $s$ és $t$ értéke megegyezik a $B$ jellemzõn, akkor $A$ értéken is megegyeznek
		\item Jelölés: $B \rightarrow A$
		\item Értelemszerûen: $A \rightarrow A$
		\item Nem kívánatos redundancia: a funkcionális függõség alapján levezethetõ információ ismételt tárolása
		\item Ezt kell megszüntetni!
		\item Miért?
	\end{itemize}
	
\end{frame}

\begin{frame}[allowframebreaks]{Anomáliák}
	
	\begin{enumerate}
		\item[\ ] Vegyük észre, az $r_{mh}$ relációban:
	
			\begin{itemize}
				\item $[$Cégnév$]$ $\rightarrow$ $[$Mh. város$]$
				\item $[$Cégnév$]$ $\rightarrow$ $[$Ir. szám$]$
				\item $[$Ir. szám$]$ $\rightarrow$ $[$Mh. város$]$
			\end{itemize}
	
		\item Beszúrási anomália
		\\Tegyük fel, hogy be akarjuk szúrni az $r_{mh}$ táblázatba a következõ sort:

	\begin{table}
	\centering
		\only<beamer>{\rowcolors[]{1}{blue!20}{blue!10} }
		\footnotesize{
		\begin{tabular}{|c|c|c|c|c|c|}
		\hline
		$r_{mh}$ & Dolgozó neve & Cégnév & Mh. város & Ir. szám \\ \hline \hline
		6 & Kelemen Evelin & Zalaegerszegi Kórház & Sopron & 7500 \\ \hline
		\end{tabular}
		}
	\end{table}

		\framebreak
		\item Törlési anomália
		
		\begin{itemize}
			\item Tegyük fel, hogy az $r_{mh}$ táblázatban kitöröljük a Soproni Kórház dolgozóit $4., 5.$ sor
			\item Ekkor törlõdik a Soproni Kórház címe is (nincs hol tárolni a továbbiakban)!
		\end{itemize}

		\item Módosítási anomália
		
		\begin{itemize}
			\item Tegyük fel, hogy megváltozik a Soproni Kórház neve, pl. Soproni Erzsébet Kórház
			\item Ekkor ezt az egyetlen változtatást a kórház minden dolgozójának sorában el kell végezni
		\end{itemize}
		
		\item[ ] Hogyan lehetne kiküszöbölni ezeket az anomáliákat?
	\end{enumerate}
	
\end{frame}

\begin{frame}{Táblák dekompozíciója}
	
	\begin{itemize}
		\item A funkcionális függõségek mentén bontsuk kisebb darabokra azokat a táblákat, amelyekben redundanciát találunk
		\item Ha a jellemzõk (oszlopok) egy $X$ részhalmaza a séma (tábla) minden jellemzõjét meghatározza, akkor azt mondjuk, hogy $X$ \textbf{szuperkulcs}
		\item Ha $X$ egyetlen jellemzõbõl áll, vagy nem hagyható el jellemzõ belõle anélkül, hogy a szuperkulcs tulajdonság sérülne, akkor azt mondjuk, hogy $X$ \textbf{kulcs}
		\item Célszerû minden táblában egy egy tagú kulcsot definiálni, pl. egy sorszámot
		\item A különbözõ táblákat ezekkel a kulcsokkal kapcsoljuk össze
		\item Így tudjuk elõállítani az eredeti, összetett táblát
	\end{itemize}
	
\end{frame}

\begin{frame}{Táblák dekompozíciója}
	
\begin{table}
		\only<beamer>{\rowcolors[]{1}{blue!20}{blue!10} }
		\footnotesize{
		\begin{tabular}{|c|c|c|c|c|c|}
		\hline
		$r_{mh}$ & Dolgozó neve & Cégnév & Mh. város & Irányítószám \\ \hline \hline
		1 & Molnár Piroska & Zalaegerszegi Kórház & Zalaegerszeg & 8900 \\ \hline
		2 & Horváth Katalin & Zalaegerszegi Kórház & Zalaegerszeg & 8900 \\ \hline
		3 & Egerszegi Judit & Zalaegerszegi Kórház & Zalaegerszeg & 8900 \\ \hline
		4 & Lenti Edit & Soproni Kórház & Sopron & 9400 \\ \hline
		5 & Keleti Edina & Soproni Kórház & Sopron & 9400 \\ \hline
		\end{tabular}
		}
\end{table}

\begin{columns}
	\begin{column}{0.5\textwidth}

		\begin{table}
				\only<beamer>{\rowcolors[]{1}{blue!20}{blue!10} }
				\footnotesize{
				\begin{tabular}{|c|c|c|}
				\hline
				$r_{dolg}$ & Dolgozó neve & Cég \\ \hline \hline
				1 & Molnár Piroska & zk \\ \hline
				2 & Horváth Katalin & zk \\ \hline
				3 & Egerszegi Judit & zk \\ \hline
				4 & Lenti Edit & sk \\ \hline
				5 & Keleti Edina & sk \\ \hline
				\end{tabular}
				}
		\end{table}

	\end{column}
	
	\begin{column}{0.5\textwidth}

		\begin{table}
				\only<beamer>{\rowcolors[]{1}{blue!20}{blue!10} }
				\footnotesize{
				\begin{tabular}{|c|c|c|}
				\hline
				$r_{ceg}$ & Cégnév & Irsz\\ \hline \hline
				zk & Zalaegerszegi Kórház & 8900 \\ \hline
				sk & Soproni Kórház & 9400 \\ \hline
				\end{tabular}
				$$\ $$
				\begin{tabular}{|c|c|}
				\hline
				$r_{irsz}$ & Város \\ \hline \hline
				8900 & Zalaegerszeg \\ \hline
				9400 & Sopron \\ \hline
				\end{tabular}
				}
		\end{table}

	\end{column}

\end{columns}
	
\end{frame}

\begin{frame}{Adatbázis-tervezés}
	
	\begin{itemize}
		\item Gyakorlatban persze nem kell utólag feldarabolni a táblákat
		\item Eleve olyan táblákat hozzunk létre, amelyekben nincsen redundancia
		\item Minden táblában csak egyféle, összetartozó adatelemeket sorolunk fel
		\item Az a jó, ha egy egyszerû mondattal meg tudjuk fogalmazni az egyes táblák tartalmát
		
		\begin{enumerate}
			\item Melyik városnak mi az irányítószáma?
			\item Melyik kórház melyik városban található (irányítószámmal)?
			\item Hol dolgoznak az emberek?
		\end{enumerate}
		
		\item Az nem volt jó tábla, hogy
		
		\begin{itemize}
			\item hol dolgoznak az emberek, melyik városban, milyen irányítószám alatt?
		\end{itemize}
		
	\end{itemize}
	
\end{frame}

\begin{frame}{Adatbázis-tervezés}
	
	\begin{itemize}
		\item Minden táblában definiálunk egy-egy kulcsot, és ezekkel hivatkozunk rá egy másik táblából
		\item Így több különbözõ táblából is használhatjuk a tábla adatait
		\item Például a fenti példában csak egy helyen kell nyilvántartanunk a városok irányítószámait, és bárhol felhasználhatjuk
		\item Ezért jelent minõségi változást az adatbázis az adattáblához képest
	\end{itemize}
	
(Ezekben a példákban az adatbázisok szerkezetére koncentráltunk. Természetesen lehetnek más szempontok is, amelyek felülbírálhatják ezeket a szempontokat. Például a program gyorsabbá tétele érdekében néha engedélyezzük a \\redundanciát.)
	
\end{frame}

\only<beamer>{
	\begin{frame}{Összefoglalás}
		\tableofcontents	
	\end{frame}
}

\begin{frame}{Befejezés}

\begin{block} {}
	
	\begin{center}
	\vspace{1cm}
	\LARGE{Köszönöm a figyelmet!}
	\vspace{1cm}
	\end{center}
	
\end{block}

\end{frame}

\end{document}
